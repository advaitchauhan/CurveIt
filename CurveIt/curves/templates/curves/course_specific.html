{% load mathfilters %}

<!DOCTYPE html>
<html>
	<head>
		<title>Curves</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
		<script src="http://code.highcharts.com/highcharts.js"></script>
	<head>
	<body>
		<h1 class="title">{{ course }}</h1>
		<div id="container" style="width:100%; height:400px;"></div>
		
		<table class="thisTable">
			{% for grade, number in dist %}
			<!-- Optional functionality: only show grades that make up >x% of grades; may be
			     useful for deciding whether to show PDF  -->
				<!-- {% if number >= total|div:20 %}  -->
					<tr>
						<td class="_grade" hidden>{{ grade }}</td>
						<td class="_numGrade" hidden>{{ number }}</td>
					</tr>
				<!-- {% endif %} -->
			{% endfor %}
		</table>

		<script>
			var _grades = [];
			var _numGrades = [];
			var courseTitle = ""
			$('.title').each(function(index){
				console.log('hi1');
				courseTitle = $(this).text();
			});
			$('._grade').each(function(index){
				console.log("hi2");
				_grades.push($(this).text());
				console.log(_grades[index]);
			});
			$('._numGrade').each(function(index){
				_numGrades.push($(this).text());
			});
			for (var i = 0; i < _numGrades.length; i++)
			{
				_numGrades[i] = parseInt(_numGrades[i]);

				// if (_numGrades[i] < 62)
				// {
				// 	_numGrades[i] = 0;
				// 	_grades[i] = '';
				// 	console.log("here");
				// }
			}
			$(function () { 
    			$('#container').highcharts({
			        chart: {
			            type: 'column'
			        },
			        title: {
			            text: courseTitle
			        },
			        xAxis: {
			        	categories: _grades,
			        	title: {
			        		text: "Grades"
			        	}
			        },
			        yAxis: {
			        	title: {
			        		text: "Numbers"
			        	}
			        },
			        plotOptions: {
            			column: {
                			pointPadding: 0.2,
                			borderWidth: 0
            			}
        			},
        			legend: {
        				enabled: false
        			},
        			tooltip: {
            			pointFormat: 'Count: <b>{point.y}</b><br/>'
        			},
			        series: [{
			        	name: courseTitle, 
			        	data: _numGrades
			        }]
			    });
			});
		</script>
	</body>
</html>